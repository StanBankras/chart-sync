{"version":3,"sources":["../../server/routes/room.js"],"names":["router","express","Router","post","req","res","room","chartCount","body","sendStatus","rooms","id","newRoom","roomId","name","tickers","activeTickers","standardTickers","i","ticker","push","db","collection","doc","set","users"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,IAAMA,MAAM,GAAGC,iBAAQC,MAAR,EAAf;;AAEAF,MAAM,CAACG,IAAP,CAAY,WAAZ;AAAA,+BAAyB,WAAOC,GAAP,EAAYC,GAAZ,EAAoB;AAC3C,QAAM;AAAEC,MAAAA,IAAF;AAAQC,MAAAA;AAAR,QAAuBH,GAAG,CAACI,IAAjC;AACA,QAAG,CAACF,IAAD,IAAS,CAACC,UAAb,EAAyB,OAAOF,GAAG,CAACI,UAAJ,CAAe,GAAf,CAAP;AACzB,QAAGC,cAAMJ,IAAI,CAACK,EAAX,CAAH,EAAmB,OAAON,GAAG,CAACI,UAAJ,CAAe,GAAf,CAAP;AAEnB,QAAMG,OAAO,GAAG;AACdC,MAAAA,MAAM,EAAEP,IAAI,CAACK,EADC;AAEdG,MAAAA,IAAI,EAAER,IAAI,CAACQ,IAFG;AAGdP,MAAAA,UAHc;AAIdQ,MAAAA,OAAO,EAAE,EAJK;AAKdC,MAAAA,aAAa,EAAE;AALD,KAAhB;AAQA,QAAMC,eAAe,GAAG,CAAC,UAAD,EAAa,UAAb,EAAyB,UAAzB,EAAqC,WAArC,CAAxB;;AACA,SAAI,IAAIC,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAAGX,UAAnB,EAA+BW,CAAC,EAAhC,EAAoC;AAClC,UAAMC,MAAM,GAAGF,eAAe,CAACC,CAAD,CAA9B;AACAN,MAAAA,OAAO,CAACG,OAAR,CAAgBI,MAAhB,IAA0B,EAA1B;AACAP,MAAAA,OAAO,CAACI,aAAR,CAAsBI,IAAtB,CAA2BD,MAA3B;AACD;;AAED,UAAME,OAAGC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BjB,IAAI,CAACK,EAAhC,EAAoCa,GAApC,CAAwCZ,OAAxC,CAAN;AACAA,IAAAA,OAAO,CAACa,KAAR,GAAgB,EAAhB;AACAf,kBAAMJ,IAAI,CAACK,EAAX,IAAiBC,OAAjB;AACAP,IAAAA,GAAG,CAACI,UAAJ,CAAe,GAAf;AACD,GAxBD;;AAAA;AAAA;AAAA;AAAA;eA0BeT,M","sourcesContent":["import express from 'express';\nimport { rooms } from '../server';\nimport { db } from '../modules/db';\n\nconst router = express.Router();\n\nrouter.post('/room/new', async (req, res) => {\n  const { room, chartCount } = req.body;\n  if(!room || !chartCount) return res.sendStatus(400);\n  if(rooms[room.id]) return res.sendStatus(409);\n\n  const newRoom = {\n    roomId: room.id,\n    name: room.name,\n    chartCount,\n    tickers: {},\n    activeTickers: []\n  };\n\n  const standardTickers = ['ETH/USDT', 'BTC/USDT', 'LTC/USDT', 'LINK/USDT'];\n  for(let i = 0; i < chartCount; i++) {\n    const ticker = standardTickers[i];\n    newRoom.tickers[ticker] = [];\n    newRoom.activeTickers.push(ticker);\n  }\n\n  await db.collection(\"rooms\").doc(room.id).set(newRoom);\n  newRoom.users = [];\n  rooms[room.id] = newRoom;\n  res.sendStatus(200);\n});\n\nexport default router;"],"file":"room.js"}